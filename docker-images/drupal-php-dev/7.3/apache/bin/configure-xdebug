#!/bin/bash
set -e

if [ ! "true" == "$XDEBUG_ENABLED" ]; then
    # Disable Xdebug.
    rm -f /usr/local/etc/php/conf.d/docker-php-pecl-xdebug.ini
else
    # Enable Xdebug.
    ln -sf /usr/local/etc/php/conf.d/docker-php-pecl-xdebug.disabled /usr/local/etc/php/conf.d/docker-php-pecl-xdebug.ini
fi

# Set the Xdebug remote_host to your host computer's IP address.
sed -i "s/xdebug\.remote_host \=.*/xdebug\.remote_host \= $XDEBUG_HOST/g" /usr/local/etc/php/conf.d/xdebug.ini

# Call the parent image CMD script.
/usr/local/bin/apache2-foreground
